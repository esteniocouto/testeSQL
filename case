SELECT FUNCIONARIOS.NOME AS NOME_FUNCIONARIO,
CARGO.NOME_CARGO AS CARGO,
EMPRESAS.NOME AS NOME_EMPRESA,
PAISES.NOME_PAIS AS PAIS,
CARGO.VALOR_SALARIO AS VALOR_SALARIO,
CASE
WHEN VALOR_SALARIO < 7112 THEN VALOR_SALARIO * 0.855
WHEN VALOR_SALARIO >= 7112 AND VALOR_SALARIO < 10732 THEN VALOR_SALARIO * 0.77
WHEN VALOR_SALARIO >= 10732 AND VALOR_SALARIO < 20332 THEN VALOR_SALARIO * 0.715
WHEN VALOR_SALARIO >= 20322 AND VALOR_SALARIO < 25075 THEN VALOR_SALARIO * 0.65
WHEN VALOR_SALARIO >= 25075 AND VALOR_SALARIO < 36967 THEN VALOR_SALARIO * 0.63
WHEN VALOR_SALARIO >= 36967 AND VALOR_SALARIO < 80882 THEN VALOR_SALARIO * 0.55
WHEN VALOR_SALARIO >= 80882 THEN VALOR_SALARIO * 0.52
END AS VALOR_SALARIO_DEDUZIDO
FROM FUNCIONARIOS
INNER JOIN CARGO ON FUNCIONARIOS.CARGO = CARGO.ID
INNER JOIN EMPRESAS ON FUNCIONARIOS.PAIS_DE_TRABALHO = EMPRESAS.PAIS
INNER JOIN PAISES ON FUNCIONARIOS.PAIS_DE_TRABALHO = PAISES.ID
WHERE PAISES.NOME_PAIS = 'Portugal';
